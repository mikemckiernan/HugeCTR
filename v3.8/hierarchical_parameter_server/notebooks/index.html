<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hierarchical Parameter Server (HPS) notebooks &mdash; Merlin HugeCTR  documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script >let toggleHintShow = 'Click to show';</script>
        <script >let toggleHintHide = 'Click to hide';</script>
        <script >let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Merlin HugeCTR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hugectr_user_guide.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hugectr_core_features.html">Core Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hugectr_feature_details_intro.html">Features in Detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/index.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/multi-modal-data/index.html">Multi-modal Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../additional_resources.html">Additional Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hugectr_contributor_guide.html">Contributing to HugeCTR</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Merlin HugeCTR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Hierarchical Parameter Server (HPS) notebooks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="hierarchical-parameter-server-hps-notebooks">
<h1>Hierarchical Parameter Server (HPS) notebooks<a class="headerlink" href="#hierarchical-parameter-server-hps-notebooks" title="Permalink to this headline"></a></h1>
<p>This directory contains a set of Jupyter notebooks that demonstrate how to use HPS in TensorFlow.</p>
<div class="section" id="hps-apis">
<h2>HPS APIs<a class="headerlink" href="#hps-apis" title="Permalink to this headline"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hierarchical_parameter_server</span><span class="o">.</span><span class="n">Init</span><span class="p">()</span>
</pre></div>
</div>
<p>This methods will initialize the HPS for all the deployed models. It needs to be called only once and must be called before any other HPS APIs.</p>
<p><strong>Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">global_batch_size</span></code>: Integer, the global batch size for HPS that is deployed on multiple GPUs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ps_config_file</span></code>: String, the JSON configuration file for HPS initialization.</p></li>
</ul>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hierarchical_parameter_server</span><span class="o">.</span><span class="n">LookupLayer</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">LookupLayer</span></code> is a subclassing <code class="docutils literal notranslate"><span class="pre">tf.keras.layers.Layer</span></code>, and <code class="docutils literal notranslate"><span class="pre">LookupLayer.call()</span></code> takes a Tensor with type int64 containing the ids to be looked up.</p>
<p><strong>Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model_name</span></code>: String, the name of the model that has embedding table(s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">table_id</span></code>: Integer, the index of the embedding table for the model specified by <code class="docutils literal notranslate"><span class="pre">model_name</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">emb_vec_size</span></code>: Integer, the embedding vector size for the embedding table specified by <code class="docutils literal notranslate"><span class="pre">model_name</span></code> and <code class="docutils literal notranslate"><span class="pre">table_id</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">emb_vec_dtype</span></code>: tensorflow.python.framework.dtypes.DType, the data type of embedding vectors which must be tf.float32 currently.</p></li>
</ul>
</div>
<div class="section" id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline"></a></h2>
<p>The simplest way to run a one of our notebooks is with a Docker container.
A container provides a self-contained, isolated, and reproducible environment for repetitive experiments.
Docker images are available from the NVIDIA GPU Cloud (NGC).
If you prefer to build the HugeCTR Docker image on your own, refer to <a class="reference external" href="https://nvidia-merlin.github.io/HugeCTR/master/hugectr_contributor_guide.html#set-up-the-development-environment-with-merlin-containers">Set Up the Development Environment With Merlin Containers</a>.</p>
<div class="section" id="pull-the-ngc-docker">
<h3>Pull the NGC Docker<a class="headerlink" href="#pull-the-ngc-docker" title="Permalink to this headline"></a></h3>
<p>Pull the container using the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker pull nvcr.io/nvidia/merlin/merlin-hugectr:22.07
</pre></div>
</div>
</div>
<div class="section" id="clone-the-hugectr-repository">
<h3>Clone the HugeCTR Repository<a class="headerlink" href="#clone-the-hugectr-repository" title="Permalink to this headline"></a></h3>
<p>Use the following command to clone the HugeCTR repository:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/NVIDIA/HugeCTR
</pre></div>
</div>
</div>
<div class="section" id="start-the-jupyter-notebook">
<h3>Start the Jupyter Notebook<a class="headerlink" href="#start-the-jupyter-notebook" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Launch the container in interactive mode (mount the HugeCTR root directory into the container for your convenience) by running this command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker run --runtime<span class="o">=</span>nvidia --rm -it --cap-add SYS_NICE -u <span class="k">$(</span>id -u<span class="k">)</span>:<span class="k">$(</span>id -g<span class="k">)</span> -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/hugectr -w /hugectr -p <span class="m">8888</span>:8888 nvcr.io/nvidia/merlin/merlin-hugectr:22.07
</pre></div>
</div>
<blockquote>
<div><p>To run the  Sparse Operation Kit notebooks, specify the <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvidia/merlin/merlin-hugectr:22.07</span></code> container.</p>
</div></blockquote>
</li>
<li><p>Start Jupyter using these commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /hugectr/notebooks
jupyter-notebook --allow-root --ip <span class="m">0</span>.0.0.0 --port <span class="m">8888</span> --NotebookApp.token<span class="o">=</span><span class="s1">&#39;hugectr&#39;</span>
</pre></div>
</div>
</li>
<li><p>Connect to your host machine using the 8888 port by accessing its IP address or name from your web browser: <code class="docutils literal notranslate"><span class="pre">http://[host</span> <span class="pre">machine]:8888</span></code></p>
<p>Use the token available from the output by running the command above to log in. For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://[host</span> <span class="pre">machine]:8888/?token=aae96ae9387cd28151868fee318c3b3581a2d794f3b25c6b</span></code></p>
</li>
</ol>
</div>
</div>
<div class="section" id="notebook-list">
<h2>Notebook List<a class="headerlink" href="#notebook-list" title="Permalink to this headline"></a></h2>
<p>Here’s a list of notebooks that you can run:</p>
<ul class="simple">
<li><p><a class="reference internal" href="hierarchical_parameter_server_demo.html"><span class="doc std std-doc">hierarchical_parameter_server_demo.ipynb</span></a>: Explains how to train with native TF layers and make inference with HPS.</p></li>
</ul>
</div>
<div class="section" id="system-specifications">
<h2>System Specifications<a class="headerlink" href="#system-specifications" title="Permalink to this headline"></a></h2>
<p>The specifications of the system on which each notebook can run successfully are summarized in the table. The notebooks are verified on the system below but it does not mean the minimum requirements.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Notebook</p></th>
<th class="head"><p>CPU</p></th>
<th class="head"><p>GPU</p></th>
<th class="head"><p>#GPUs</p></th>
<th class="head"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="hierarchical_parameter_server_demo.html"><span class="doc std std-doc">hierarchical_parameter_server_demo.ipynb</span></a></p></td>
<td><p>Intel® Xeon® CPU E5-2698 v4 &#64; 2.20GHz<br />512 GB Memory</p></td>
<td><p>Tesla V100-SXM2-32GB<br />32 GB Memory</p></td>
<td><p>1</p></td>
<td><p>Kingsley Liu</p></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v3.8
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../v3.6/index.html">v3.6</a></dd>
      <dd><a href="../../../v3.7/index.html">v3.7</a></dd>
      <dd><a href="index.html">v3.8</a></dd>
      <dd><a href="../../../v3.9/index.html">v3.9</a></dd>
      <dd><a href="../../../v3.9.1/index.html">v3.9.1</a></dd>
      <dd><a href="../../../v4.0/index.html">v4.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../../main/index.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>